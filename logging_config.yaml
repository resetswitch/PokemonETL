# logging.yaml
# --------------------------------------------------------------
# Central logging configuration for a Python app that talks to an API.
# --------------------------------------------------------------

version: 1
disable_existing_loggers: false

formatters:
  # Human‑readable, single‑line format
  standard:
    format: "%(asctime)s | %(levelname)-8s | %(funcName)s | %(module)s:%(lineno)d | %(message)s"
    datefmt: "%Y-%m-%d %H:%M:%S"

  # Optional JSON formatter – handy for ELK, Datadog, Loki, etc.
  json:
    format: >-
      {"ts":"%(asctime)s","lvl":"%(levelname)s","logger":"%(name)s","msg":%(message)s}
    datefmt: "%Y-%m-%dT%H:%M:%S%z"

handlers:
  # Console output – INFO and above go to stdout
  console:
    class: logging.StreamHandler
    level: WARNING
    formatter: standard
    stream: ext://sys.stdout

  # Rotating file handler – daily rotation, keep two weeks of logs
  file:
    class: logging.handlers.TimedRotatingFileHandler
    level: DEBUG
    formatter: standard
    filename: ${LOG_FILE_PATH}
    when: midnight          # rotate at midnight each day
    backupCount: 14         # keep the last 14 files (≈2 weeks)
    encoding: utf-8

loggers:

  initialize_db:
    level: INFO
    handlers: [console, file]
    propagate: false
  utility:
      level: INFO
      handlers: [console, file]
      propagate: false
  async_poke_api_etl:
      level: INFO
      handlers: [console, file]
      propagate: false
  async_main:
      level: INFO
      handlers: [console, file]
      propagate: false
  # Keep third‑party libraries quiet unless something serious happens
  urllib3:
    level: WARNING
    handlers: []                # inherit root handlers only

root:
  level: WARNING
  handlers: [console, file]
